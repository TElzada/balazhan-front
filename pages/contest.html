<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Конкурс — подробности</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../styles/style.css">
</head>
<body>
<div class="container my-4">
    <a href="contests.html" class="btn btn-link mb-3">← Назад к списку конкурсов</a>
    <article id="contest" class="card p-3"></article>
</div>

<script>
    (async function(){
        const params = new URLSearchParams(location.search);
        const slug = params.get('slug');
        const container = document.getElementById('contest');

        if (!slug) {
            container.innerHTML = '<p class="text-danger">Не указан конкурс.</p>';
            return;
        }

        try {
            const res = await fetch('data/contests.json');
            if(!res.ok) throw new Error('Не удалось загрузить данные');
            const list = await res.json();
            const it = list.find(x => x.slug === slug);
            if(!it) {
                container.innerHTML = '<p class="text-muted">Конкурс не найден.</p>';
                return;
            }

            container.innerHTML = `
          <div class="row g-4">
            <div class="col-12 col-md-4">
              ${ it.imageUrl ? `<img src="${it.imageUrl}" alt="${it.title}" class="img-fluid rounded">` : '' }
              <div class="mt-3"><strong>Сроки:</strong> ${it.startDate || ''} ${it.endDate ? '— ' + it.endDate : ''}</div>
              <div class="mt-2"><strong>Категория:</strong> ${it.category === 'teacher' ? 'Для педагогов' : it.category === 'kid' ? 'Для детей' : 'Для всех'}</div>
            </div>
            <div class="col-12 col-md-8">
              <h2>${it.title}</h2>
              <p class="lead">${it.excerpt || ''}</p>
              <hr>
              <h5>Этапы</h5>
              <ul>
                ${ (it.stages || []).map(s => `<li><strong>${s.title}</strong> — ${s.date}: ${s.description}</li>`).join('') }
              </ul>
              <hr>
              <div>${it.content || ''}</div>
            </div>
          </div>
        `;
        } catch (e) {
            console.error(e);
            container.innerHTML = '<p class="text-danger">Ошибка загрузки данных.</p>';
        }
    })();
</script>
</body>
</html>
